<!DOCTYPE html>
<html>
<head>
  <title>AFSCO Portal</title>
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
  <%= javascript_importmap_tags %>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <link href="https://fonts.googleapis.com/css2?family=Cabin:wght@400;500;600;700&display=swap" rel="stylesheet">

</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
      <%= link_to root_path, class: 'navbar-brand' do %>
        <%= image_tag 'circle-logo.png', alt: 'AFSCO Logo' %>
      <% end %>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <%= link_to 'Home', root_path, class: 'nav-link' %>
          </li>
          <li class="nav-item">
            <%= link_to 'Jobs', jobs_path, class: 'nav-link' %>
          </li>
          <li class="nav-item">
            <%= link_to 'Map', map_path, class: 'nav-link' %>
          </li>
          <% if current_user && current_user.super_admin? %>
            <li class="nav-item">
              <%= link_to 'Manage Crews', crews_path, class: 'nav-link' %>
            </li>
          <% end %>
        </ul>
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <div id="current-time" class="nav-link" style="font-weight: bold;"></div>
          </li>
          <% if user_signed_in? %>
            <% if current_user.super_admin? %>
              <li class="nav-item">
                <%= link_to 'Manage Users', admin_users_path, class: 'btn btn-outline-primary mr-2' %>
              </li>
            <% end %>
            <li class="nav-item">
              <%= link_to 'Logout', destroy_user_session_path, method: :delete, data: { no_turbolink: true }, class: 'nav-link' %>
            </li>
          <% else %>
            <li class="nav-item">
              <%= link_to 'Login', new_user_session_path, class: 'nav-link' %>
            </li>
          <% end %>
        </ul>
      </div>
    </div>
  </nav>

  <% if notice %>
    <p class="notice"><%= notice %></p>
  <% end %>
  <% if alert %>
    <p class="alert"><%= alert %></p>
  <% end %>

  <%= yield %>

  <script>
    function updateTime() {
      var now = new Date();
      var timeString = now.toLocaleString();
      document.getElementById('current-time').innerText = timeString;
    }
    setInterval(updateTime, 1000);
    updateTime(); // Initial call to display the time immediately on load
  </script>
      <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha384-KjoPJN9ldfbKYyyJbLa3e2e3Bd/Om8lHym/R+74xl/fWtNf4n/LEe4ntNzOlLFOC" crossorigin=""></script>

</body>
</html>
